"use strict";(self.webpackChunkmonodb_docs=self.webpackChunkmonodb_docs||[]).push([[863],{6264:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"architecture/overview","title":"Architecture Overview","description":"MonoDB is designed with modularity and performance in mind. This document provides an overview of the system architecture.","source":"@site/docs/architecture/overview.md","sourceDirName":"architecture","slug":"/architecture/overview","permalink":"/Mono-DB/docs/architecture/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/Jacob-Walton/Mono-DB/tree/main/monodb-docs/docs/architecture/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Architecture Overview","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/Mono-DB/docs/getting-started"},"next":{"title":"NSQL Language Reference","permalink":"/Mono-DB/docs/nsql-reference"}}');var s=i(4848),t=i(8453);const o={title:"Architecture Overview",sidebar_position:1},l="MonoDB Architecture",a={},c=[{value:"System Components",id:"system-components",level:2},{value:"Core Components",id:"core-components",level:2},{value:"1. Storage Engine",id:"1-storage-engine",level:3},{value:"2. Transaction Manager",id:"2-transaction-manager",level:3},{value:"3. Query Processor",id:"3-query-processor",level:3},{value:"4. Network Layer",id:"4-network-layer",level:3},{value:"Data Organization",id:"data-organization",level:2},{value:"Pages",id:"pages",level:3},{value:"Tables",id:"tables",level:3},{value:"Write-Ahead Log",id:"write-ahead-log",level:3},{value:"Query Execution Flow",id:"query-execution-flow",level:2},{value:"Concurrency Control",id:"concurrency-control",level:2},{value:"Memory Management",id:"memory-management",level:2},{value:"Future Goals",id:"future-goals",level:2},{value:"Distributed Architecture",id:"distributed-architecture",level:3},{value:"Query Optimization",id:"query-optimization",level:3},{value:"Storage Improvements",id:"storage-improvements",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Current Limitations",id:"current-limitations",level:3},{value:"Optimization Tips",id:"optimization-tips",level:3},{value:"Monitoring and Debugging",id:"monitoring-and-debugging",level:2},{value:"Planned Features",id:"planned-features",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"monodb-architecture",children:"MonoDB Architecture"})}),"\n",(0,s.jsx)(n.p,{children:"MonoDB is designed with modularity and performance in mind. This document provides an overview of the system architecture."}),"\n",(0,s.jsx)(n.admonition,{title:"Work in Progress",type:"warning",children:(0,s.jsx)(n.p,{children:"The architecture is evolving. Some components described here may be partially implemented or planned for future releases."})}),"\n",(0,s.jsx)(n.h2,{id:"system-components",children:"System Components"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"   \u2002\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     Client Applications                     \u2502\n\u2502                    (REPL, Drivers, etc.)                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Network Layer                        \u2502\n\u2502                  (Binary Protocol over TCP)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       Query Processor                       \u2502\n\u2502                 (Parser, Planner, Executor)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     Transaction Manager                     \u2502\n\u2502              (ACID, Isolation Levels, Locking)              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Storage Engine                       \u2502\n\u2502           (Buffer Pool, Pages, WAL, Disk Manager)           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h2,{id:"core-components",children:"Core Components"}),"\n",(0,s.jsx)(n.h3,{id:"1-storage-engine",children:"1. Storage Engine"}),"\n",(0,s.jsx)(n.p,{children:"This storage engine provides, persistent, ACID-compliant data storage:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Page Management"}),": Data is stored in fixed-size pages (8KB)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Buffer Pool"}),": LRU cache for frequently accessed pages"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Write-Ahead Logging"}),": Ensures durability and crash recovery"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Disk Manager"}),": Handles phsyical I/O operations"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-transaction-manager",children:"2. Transaction Manager"}),"\n",(0,s.jsx)(n.p,{children:"Manages concurrent access and ensures ACID properties:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Isolation Levels"}),": Supports Read Uncommitted, Read Committed, Repeatable Read, and Serializable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lock Manager"}),": Row-level and table-level locking"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MVCC"}),": Planned for future releases"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-query-processor",children:"3. Query Processor"}),"\n",(0,s.jsx)(n.p,{children:"Handles SQL parsing and execution"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parser"}),": Converts SQL/NSQL to Abstract Syntax Tree (AST)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Planner"}),": Current basic; query optimization is planned"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Executor"}),": Executes query plans against storage engine"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-network-layer",children:"4. Network Layer"}),"\n",(0,s.jsx)(n.p,{children:"Custom binary protocol for client-server communication:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Message Format"}),": Length-prefixed JSON messages"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Connection Management"}),": Handles multiple concurrent clients"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Heartbeat"}),": Keeps connections alive"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"data-organization",children:"Data Organization"}),"\n",(0,s.jsx)(n.h3,{id:"pages",children:"Pages"}),"\n",(0,s.jsx)(n.p,{children:"The fundamental unit of storage:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub struct Page {\n    pub header: PageHeader,\n    pub data: Vec<u8>,\n}\n\npub struct PageHeader {\n\tpub magic: u32,             // Magic number for validation\n\tpub page_id: u32,           // Page ID\n\tpub page_type: u8,          // Page type\n\tpub flags: u8,              // Flags (dirty, pinned, etc.)\n\tpub lsn: u64,               // Last LSN that modified this page\n\tpub free_space_offset: u16, // Offset to free space\n\tpub tuple_count: u16,       // Number of tuples\n\tpub next_page_id: u32,      // Next page in chain (for overflow)\n\tpub prev_page_id: u32,      // Previous page in chain\n\tpub checksum: u32,          // CRC32 checksum\n\tpub _reserved: [u8; 28],    // Reserved for future use\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"tables",children:"Tables"}),"\n",(0,s.jsx)(n.p,{children:"Tables are collections of pages containing tuples (AKA records):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Heap Files"}),": Currently, all tables use heap file organization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Indexes"}),": B-tree indexes are planned but not yet implemented"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"write-ahead-log",children:"Write-Ahead Log"}),"\n",(0,s.jsx)(n.p,{children:"Every modification is logged before being applied:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Log Sequence Numbers (LSN)"}),": Ensure ordering"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Checkpoints"}),": Periodic flushing to reduce recovery time"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recovery"}),": Replay log from last checkpoint"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"query-execution-flow",children:"Query Execution Flow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parse"}),": SQL text -> AST"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Plan"}),": AST -> Execution plan (currently basic)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Execute"}),": Run plan against storage engine"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Return"}),": Format results for client"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"concurrency-control",children:"Concurrency Control"}),"\n",(0,s.jsx)(n.p,{children:"Currently uses pessimistic locking:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Shared locks"})," for reads"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Exclusive locks"})," for writes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Deadlock detection"}),": Planned for future"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"memory-management",children:"Memory Management"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Buffer Pool"}),": Configurable size, LRU eviction"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Query Memory"}),": Currently unbounded (improvement planned)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Connection Memory"}),": Per-connection buffers"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"future-goals",children:"Future Goals"}),"\n",(0,s.jsx)(n.h3,{id:"distributed-architecture",children:"Distributed Architecture"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sharding support"}),"\n",(0,s.jsx)(n.li,{children:"Replication (primary-replica)"}),"\n",(0,s.jsx)(n.li,{children:"Distributed transactions"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"query-optimization",children:"Query Optimization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cost-based optimizer"}),"\n",(0,s.jsx)(n.li,{children:"Statistics collections"}),"\n",(0,s.jsx)(n.li,{children:"Join algorithms"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"storage-improvements",children:"Storage Improvements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Columnar storage option"}),"\n",(0,s.jsx)(n.li,{children:"Compression"}),"\n",(0,s.jsx)(n.li,{children:"Partitioning"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"current-limitations",children:"Current Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Single-threaded query execution"}),"\n",(0,s.jsx)(n.li,{children:"No query result caching"}),"\n",(0,s.jsx)(n.li,{children:"Limited index support"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"optimization-tips",children:"Optimization Tips"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Keep transactions short"}),"\n",(0,s.jsx)(n.li,{children:"Use appropriate data types"}),"\n",(0,s.jsx)(n.li,{children:"Monitor buffer pool hit rate"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"monitoring-and-debugging",children:"Monitoring and Debugging"}),"\n",(0,s.jsx)(n.admonition,{title:"Coming Soon",type:"note",children:(0,s.jsx)(n.p,{children:"Monitoring and profiling tools are planned but not yet available"})}),"\n",(0,s.jsx)(n.h3,{id:"planned-features",children:"Planned Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Query execution stats"}),"\n",(0,s.jsx)(n.li,{children:"Buffer pool metrics"}),"\n",(0,s.jsx)(n.li,{children:"Lock contention analysis"}),"\n",(0,s.jsx)(n.li,{children:"Slow query log"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var r=i(6540);const s={},t=r.createContext(s);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);